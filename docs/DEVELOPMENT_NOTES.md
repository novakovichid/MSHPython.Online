# Заметки о разработке

## Табуляция и перенос строк в редакторе
- Настройки "Таб" и "Перенос" скрыты из интерфейса.
- Значения зафиксированы: таб = 4, перенос выключен.
- Перенос строк отключён из-за нестабильной работы в текущем редакторе.

## Проблема с формами черепахи и фоном

### Наблюдаемое поведение
- Изображения загружаются в "Ресурсы" (видны файлы)
- `Screen().addshape("image.png")` вызывается без ошибок
- `turtle.shape("image.png")` вызывается без ошибок
- **НО:** черепаха не показывает форму из изображения, остаётся треугольником

### Анализ

#### Почему это не работает
Skulpt - это интерпретатор Python, скомпилированный в JavaScript. Его встроенная библиотека turtle графики имеет ограничения:

1. **Shape класс не поддерживает изображения по имени файла**
   - `Shape("image", "image.png")` создаёт объект, но не загружает изображение
   - Skulpt не знает как получить URL или данные файла

2. **Нет механизма связи между Python файловой системой и web ассетами**
   - Python код вызывает `turtle.shape("disco_ball.png")`
   - Но turtle graphics не знает где взять этот файл в браузере

3. **Это работает на trinket.io потому что:**
   - Trinket.io использует другую конфигурацию/версию Skulpt
   - Или у них есть кастомный код для загрузки изображений
   - Или они используют совсем другой механизм

#### Что было попробовано
1. Создание `Shape("image", name)` - не помогло, форма не загружается
2. Добавление `Sk.imageProxy` функции - требует работающего механизма загрузки
3. Сохранение строки вместо Shape объекта - turtle не знает что с ней делать

### Возможные решения

#### 1. Использовать координаты вместо изображений
```python
# Вместо:
turtle.shape("disco_ball.png")

# Использовать:
shape_coords = [(0,0), (10,10), (10,0)]  # Определить форму
turtle.shape(shape_coords)
```

#### 2. Загрузить изображение и преобразовать в координаты
Создать скрипт, который:
- Загружает PNG
- Трассирует контур
- Генерирует координаты
- Вставляет в Python код

#### 3. Создать кастомный механизм для turtle shapes
- Перехватить вызовы `turtle.shape()`
- Загрузить изображение из ассетов
- Преобразовать в что-то, что Skulpt может использовать

#### 4. Использовать другой подход рисования
- Вместо встроенной turtle
- Использовать canvas/SVG напрямую
- Полностью кастомное рисование

### Выводы
Это не ошибка в коде, а архитектурное ограничение Skulpt.
Для полной поддержки изображений нужна либо:
- Новая версия Skulpt с поддержкой
- Кастомный слой для работы с изображениями
- Другой подход к рисованию (не turtle)

## Импорт файлов
- Сейчас импорт поддерживает `.py` файлы, ZIP и JSON (в формате экспорта).
- При импорте ZIP игнорируются не-`.py` файлы и подпапки "сплющиваются" в корень.
- При конфликте имён предлагается замена или автоимя с номерным суффиксом.
- Потенциал на будущее: импорт изображений/ресурсов из архива и автоматическое добавление в assets.

## Адаптивный UI (tablet/mobile)

### Брейкпоинты
- Tablet: `max-width: 1024px`
- Mobile: `max-width: 768px`

### Текущие договорённости
- На планшете фокус компоновки на `editor + turtle + console`; модули остаются в узкой колонке.
- На мобилке используется карточный режим с нижней навигацией.
- В compact view (`<=1024px`) подсказка консольного ввода: `Введите input и нажмите «Отправить»`.
- Кнопка `Горячие клавиши` скрыта на планшете и мобилке.
- Для мобильных кнопок поддерживается touch-friendly размер (ориентир 44px по высоте).

### Что важно при правках
- Изменения layout вносятся в `assets/skulpt-styles.css` (single-runtime).
- JS-логика responsive/card state вносится в `assets/skulpt-app.js` (single-runtime).
- Артефакты в `assets/archive/` считаются неисполняемым архивом и не подключаются в runtime.
- После изменений обязательно проверять:
  - переключение карточек на mobile,
  - пост-run автопереход на `turtle/console`,
  - отсутствие дрейфа редактора после resize/переключений,
  - читаемость кнопок модулей на планшете.
